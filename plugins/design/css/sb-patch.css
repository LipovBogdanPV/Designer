/* ========= sb-patch.css ========= */
/* Шапка завжди зверху, НЕ рухається разом із сайдбаром */
header, .header, .topbar, header-block.topbar {
  position: sticky;
  top: 0;
  z-index: 100;
  display: block;
  width: 100%;
}




/* Глобальні змінні для сайдбару */
:root {
  --sb-side: right;     /* right | left (керує JS) */
  --sb-width: 320px;    /* поточна ширина сайдбару (керує JS) */
  --sb-maxvw: 30vw;     /* ліміт ширини 30% екрана */
  --hdr-h: 56px;        /* висота шапки (перераховує JS) */
}

/* Контент відпихаємо від сайдбару */
/* fallback: використовуємо локальну змінну, або глобальну, якщо перша відсутня */
#main, .main, #app, #canvasWrap, #canvas {
  padding-top: var(--builder-hdr-h, var(--hdr-h));
  transition: margin .15s ease;
}

/* Відступи контенту залежно від сторони сайдбару */
body[data-sb="right"] #main,
body[data-sb="right"] .main,
body[data-sb="right"] #app,
body[data-sb="right"] #canvasWrap,
body[data-sb="right"] #canvas {
  margin-right: var(--sb-width);
  margin-left: 0;
}

body[data-sb="left"] #main,
body[data-sb="left"] .main,
body[data-sb="left"] #app,
body[data-sb="left"] #canvasWrap,
body[data-sb="left"] #canvas {
  margin-left: var(--sb-width);
  margin-right: 0;
}

/* Сам сайдбар: фіксований під шапкою, притиснутий до краю екрана */
.right-panel, #rightPanel, #inspector, [data-role="sidebar"], .properties, .inspector {
  position: fixed;
  top: var(--hdr-h);
  bottom: 0;
  width: var(--sb-width);
  max-width: var(--sb-maxvw);
  min-width: 260px;
  overflow: auto;
  background: var(--surface, #fff);
  border-left: 1px solid var(--border, #e5e7eb);
  border-right: 1px solid var(--border, #e5e7eb);
  z-index: 99;
  transition: width .1s ease, left .1s ease, right .1s ease;
}

/* Прив’язка праворуч / ліворуч */
body[data-sb="right"] .right-panel,
body[data-sb="right"] #rightPanel,
body[data-sb="right"] #inspector,
body[data-sb="right"] [data-role="sidebar"],
body[data-sb="right"] .properties,
body[data-sb="right"] .inspector {
  right: 0; left: auto;
  border-left: 1px solid var(--border, #e5e7eb);
  border-right: none;
}

body[data-sb="left"] .right-panel,
body[data-sb="left"] #rightPanel,
body[data-sb="left"] #inspector,
body[data-sb="left"] [data-role="sidebar"],
body[data-sb="left"] .properties,
body[data-sb="left"] .inspector {
  left: 0; right: auto;
  border-right: 1px solid var(--border, #e5e7eb);
  border-left: none;
}

/* Невидима «хватка» для ресайзу (по краю сайдбару) */
#sbGrip {
  position: absolute;
  top: 0; bottom: 0;
  width: 8px;
  cursor: col-resize;
  opacity: .001;
}
body[data-sb="right"] #sbGrip { left: 0; }
body[data-sb="left"]  #sbGrip { right: 0; }

/* Кнопка ↔ переміщення сайдбару (JS додає в шапку) */
#sbPlaceBtn {
  width: 32px; height: 32px;
  display: inline-flex; align-items: center; justify-content: center;
  border-radius: 999px;
  border: 1px solid var(--border, #e5e7eb);
  background: var(--surface, #fff);
  margin-left: 8px;
  cursor: pointer;
}

/* Стилі для аккордеонів у сайдбарі — НЕ міняємо твої класи, лише додаємо службові */
.sb-section {
  border: 1px solid var(--border, #e5e7eb);
  border-radius: 10px;
  background: var(--surface, #fff);
  margin-bottom: 10px;
}
.sb-section__hdr {
  display: flex; align-items: center; justify-content: space-between;
  padding: 10px 12px; font-weight: 600; cursor: pointer; user-select: none;
}
.sb-section__body { padding: 10px 12px; }

/* Згорнутий стан — ховається лише власне тіло блоку */
.sb-collapsed > .sb-section__body { display: none; }


/* ==== Топбар віджета: завжди зверху і незалежний від сайдбару ==== */
header-block.topbar,
.topbar#topbar {
  position: sticky;
  top: 0;
  z-index: 500;       /* вище контенту й сайдбару */
  display: block;
  width: 100%;
  background: var(--surface, #fff);
  color: var(--text, #0f172a);
  border-bottom: 1px solid var(--border, #e5e7eb);
}

/* Сайдбар — fixed під шапкою віджета */
[data-role="sidebar"] {
  position: fixed;
  top: var(--builder-hdr-h, var(--hdr-h, 56px));
  bottom: 0;
  width: var(--sb-width, 320px);
  max-width: var(--sb-maxvw, 30vw);
  overflow: auto;
}

/* Сторона сайдбару */
body[data-sb="right"] [data-role="sidebar"] { right: 0; left: auto; }
body[data-sb="left"]  [data-role="sidebar"] { left: 0;  right: auto; }

/* Хватка для ресайзу */
#sbGrip {
  position: absolute;
  top: 0; bottom: 0;
  width: 8px;
  cursor: col-resize;
}
body[data-sb="right"] #sbGrip { left: 0; }
body[data-sb="left"]  #sbGrip { right: 0; }

/* ВІДСТУПИ ВІД САЙДБАРУ: тільки для робочої області, не для шапки */
body[data-sb="right"] #app,
body[data-sb="right"] #main,
body[data-sb="right"] .main,
body[data-sb="right"] #canvasWrap {
  margin-right: var(--sb-width, 320px);
}
body[data-sb="left"] #app,
body[data-sb="left"] #main,
body[data-sb="left"] .main,
body[data-sb="left"] #canvasWrap {
  margin-left: var(--sb-width, 320px);
}

/* Гарантовано НЕ зміщуємо шапку ні вліво, ні вправо */
body[data-sb] header-block.topbar,
body[data-sb] header,
body[data-sb] .header,
body[data-sb] .topbar {
  margin-left: 0 !important;
  margin-right: 0 !important;
}

/* Висота робочої області під шапкою (відступ зверху) */
#app, #main, .main, #canvasWrap, #canvas {
  padding-top: var(--builder-hdr-h, var(--hdr-h, 56px));
  box-sizing: border-box;
}
